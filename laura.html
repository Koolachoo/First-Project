<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.1/build/pure-min.css"
    integrity="sha384-oAOxQR6DkCoMliIh8yFnu25d7Eq/PHS21PClpwjOTeU2jRSq11vu66rf90/cZr47" crossorigin="anonymous">
  <!--[if lte IE 8]>
    <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.1/build/grids-responsive-old-ie-min.css">
<![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.1/build/grids-responsive-min.css">
  <!--<![endif]-->
  <title>Lyrics and Tour Dates</title>
</head>

<body>

  <form class="pure-form pure-form-stacked">
    <fieldset>
      <legend>Find the Lyrics and Tour Dates</legend>

      <div class="pure-g">

        <div class="pure-u-1 pure-u-md-1-8">
          <label for="lyrics">Title or Lyrics</label>
          <select id="lyrics" class="pure-input-1-2">
            <option id="title-search">Title</option>
            <option id="lyrics-search">Lyrics</option>
          </select>
        </div>
        <div class="pure-u-1 pure-u-md-1-5">
          <label for="search">Search</label>
          <input id="search" class="pure-u-23-24" type="text">
        </div>

      </div>
      <button type="submit" id="submitBtn" class="pure-button pure-button-primary">Submit</button>
    </fieldset>
  </form>

  <!-- Artist Information -->
  <div id="lyrics-div"></div>

</body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="script.js"></script>
<script>

  function searchTitle(title) {
    $.ajax({
      type: "GET",
      url: "https://app.ticketmaster.com/discovery/v2/events.json?&apikey=6sAAxZwe571GmYrIVOdWuurpbXAwRhWo&keyword=" + title,
      async: true,
      dataType: "json",
      success: function (response) {

        var artistName = $("<h1>").text(response._embedded.events[0].name);
        $("#lyrics-div").append(artistName);

        for (var i = 0; i < response._embedded.events.length; i++) {
          console.log(response._embedded.events[i]);
          var artistInfo = response._embedded.events[i];
          var tourDate = $("<h3>").text(artistInfo._embedded.venues[0].city.name + ", " + artistInfo._embedded.venues[0].state.stateCode)
          var venue = $("<h3>").text(artistInfo._embedded.venues[0].name)
          var tickets = $("<a>").attr("href", artistInfo._embedded.venues[0].url).text("Get tickets here")
          //$("#lyrics-div").empty();
          $("#lyrics-div").append(tourDate);
          $("#lyrics-div").append(venue);
          $("#lyrics-div").append(tickets);
        }
      },
      error: function (xhr, status, err) {
        // This time, we do not end up here!
      }
    });
  }

  function searchBandsInTown(artist) {

    // Querying the bandsintown api for the selected artist, the ?app_id parameter is required, but can equal anything
    var queryURL = "https://rest.bandsintown.com/artists/" + artist + "?app_id=codingbootcamp";
    $.ajax({
      url: queryURL,
      method: "GET"
    }).then(function (response) {

//       // Printing the entire object to console
//       console.log(response);

//       // Constructing HTML containing the artist information
//       var artistName = $("<h1>").text(response.name);
//       var artistURL = $("<a>").attr("href", response.url).append(artistName);
//       var artistImage = $("<img>").attr("src", response.thumb_url);
//       var trackerCount = $("<h2>").text(response.tracker_count + " fans tracking this artist");
//       var upcomingEvents = $("<h2>").text(response.upcoming_event_count + " upcoming events");
//       var goToArtist = $("<a>").attr("href", response.url).text("See Tour Dates");

//       // Empty the contents of the lyrics-div, append the new artist content
//       $("#lyrics-div").empty();
//       $("#lyrics-div").append(artistURL, artistImage, trackerCount, upcomingEvents, goToArtist);
//     });
//   }

  $("#submitBtn").on("click", function (event) {
    event.preventDefault();
    var inputSong = $("#search").val().trim();
    searchTitle(inputSong);
  });
</script>

</html>